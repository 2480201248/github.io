$(function(){ 
    var data3 = {
        '日期': ["2020-06-01", "2020-06-02", "2020-06-03", "2020-06-04", "2020-06-05", "2020-06-06", "2020-06-07", "2020-06-08", "2020-06-09", "2020-06-10", "2020-06-11", "2020-06-12", "2020-06-13", "2020-06-14", "2020-06-15", "2020-06-16", "2020-06-17", "2020-06-18", "2020-06-19", "2020-06-20", "2020-06-21", "2020-06-22", "2020-06-23", "2020-06-24", "2020-06-25", "2020-06-26", "2020-06-27", "2020-06-28", "2020-06-29", "2020-06-30", "2020-07-01", "2020-07-02", "2020-07-03", "2020-07-04", "2020-07-05", "2020-07-06", "2020-07-07", "2020-07-08", "2020-07-09", "2020-07-10", "2020-07-11", "2020-07-12", "2020-07-13", "2020-07-14", "2020-07-15", "2020-07-16", "2020-07-17", "2020-07-18", "2020-07-19", "2020-07-20", "2020-07-21", "2020-07-22", "2020-07-23", "2020-07-24", "2020-07-25", "2020-07-26", "2020-07-27", "2020-07-28", "2020-07-29", "2020-07-30", "2020-07-31", "2020-08-01", "2020-08-02", "2020-08-03", "2020-08-04", "2020-08-05", "2020-08-06", "2020-08-07", "2020-08-08", "2020-08-09", "2020-08-10", "2020-08-11", "2020-08-12", "2020-08-13", "2020-08-14", "2020-08-15", "2020-08-16", "2020-08-17", "2020-08-18", "2020-08-19", "2020-08-20", "2020-08-21", "2020-08-22", "2020-08-23", "2020-08-24", "2020-08-25", "2020-08-26", "2020-08-27", "2020-08-28", "2020-08-29", "2020-08-30", "2020-08-31", "2020-09-01", "2020-09-02", "2020-09-03", "2020-09-04", "2020-09-05", "2020-09-06", "2020-09-07", "2020-09-08", "2020-09-09", "2020-09-10", "2020-09-11", "2020-09-12", "2020-09-13", "2020-09-14", "2020-09-15", "2020-09-16", "2020-09-17", "2020-09-18", "2020-09-19", "2020-09-20", "2020-09-21", "2020-09-22", "2020-09-23", "2020-09-24", "2020-09-25", "2020-09-26", "2020-09-27", "2020-09-28", "2020-09-29", "2020-09-30", "2020-10-01", "2020-10-02", "2020-10-03", "2020-10-04", "2020-10-05", "2020-10-06", "2020-10-07", "2020-10-08", "2020-10-09", "2020-10-10", "2020-10-11", "2020-10-12", "2020-10-13", "2020-10-14", "2020-10-15", "2020-10-16", "2020-10-17", "2020-10-18", "2020-10-19", "2020-10-20", "2020-10-21", "2020-10-22", "2020-10-23", "2020-10-24", "2020-10-25", "2020-10-26", "2020-10-27", "2020-10-28", "2020-10-29"],
        '采购单价': [11.1, 19.4, 12.9, 10.2, 13.1, 15.8, 15.1, 17.1, 18.6, 18.9, 10.3, 19.4, 17.3, 18.0, 18.7, 19.0, 16.8, 10.9, 16.2, 13.3, 15.2, 10.3, 11.1, 19.0, 10.0, 19.0, 10.6, 19.7, 15.0, 19.7, 18.2, 11.3, 13.0, 13.4, 15.4, 16.7, 19.9, 13.8, 10.6, 13.3, 18.3, 19.1, 14.5, 12.4, 17.4, 14.6, 10.1, 10.2, 16.8, 14.2, 12.4, 10.4, 16.7, 14.9, 14.1, 18.8, 16.0, 16.8, 18.9, 14.2, 19.1, 15.1, 10.8, 19.0, 17.9, 10.8, 13.4, 17.7, 17.5, 11.1, 17.1, 14.2, 11.7, 10.1, 18.2, 16.5, 12.8, 18.5, 18.4, 10.3, 15.5, 17.6, 10.9, 16.9, 16.7, 14.1, 16.1, 14.1, 11.6, 18.3, 11.0, 11.4, 13.0, 12.9, 14.9, 13.7, 13.1, 18.6, 12.1, 12.6, 14.8, 17.6, 18.5, 15.8, 10.9, 18.8, 15.2, 18.5, 11.2, 14.9, 10.3, 15.5, 11.6, 19.9, 13.8, 13.6, 11.7, 11.0, 14.4, 10.0, 17.4, 14.1, 19.5, 13.1, 13.2, 11.1, 17.8, 16.3, 15.9, 16.4, 17.3, 18.7, 15.8, 19.7, 14.6, 11.7, 10.2, 16.9, 11.7, 18.4, 16.1, 18.1, 15.3, 19.2, 15.3, 19.2, 18.8, 12.6, 16.2, 19.8, 12.7]
    };
    var currentIndex = 0;
    var updateInterval = 1000; // 更新间隔，例如1000毫秒（1秒）

    // 初始化图表
    var chart1 = echarts.init(document.getElementById('chart1'));
    var option1 = {
        title: {
            text: '采购单价趋势'
        },
        tooltip: {
            trigger: 'axis'
        },
        xAxis: {
            type: 'category',
            data: []
        },
        yAxis: {
            type: 'value'
        },
        series: [{
            data: [],
            type: 'line'
        }]
    };
    chart1.setOption(option1);

    // 定时添加新数据
    setInterval(function() {
        if (currentIndex < data3['日期'].length) {
            var nextIndex = Math.min(currentIndex + 50, data3['日期'].length);
            for (var i = currentIndex; i < nextIndex; i++) {
                option1.xAxis.data.push(data3['日期'][i]);
                option1.series[0].data.push(data3['采购单价'][i]);
            }
            chart1.setOption(option1);
            currentIndex = nextIndex;
        }
    }, updateInterval);


    var chart2 = echarts.init(document.getElementById('chart2'));
    var option2 = {
        title: {
            text: '联系人占比'
        },
        tooltip: {
            trigger: 'item',
            formatter: '{a} <br/>{b}: {c} ({d}%)'
        },
        series: [{
            name: '联系人',
            type: 'pie',
            radius: '50%',
            data: [{"name": "\u5f20\u4e09", "value": 5}, {"name": "\u674e\u56db", "value": 4}, {"name": "\u738b\u4e94", "value": 4}],
            emphasis: {
                itemStyle: {
                    shadowBlur: 10,
                    shadowOffsetX: 0,
                    shadowColor: 'rgba(0, 0, 0, 0.5)'
                }
            }
        }]
    };
    chart2.setOption(option2);





    // 添加动态效果
    var currentIndex = -1;
    setInterval(function () {
        var dataLen = option1.series[0].data.length;
        chart1.dispatchAction({
            type: 'showTip',
            seriesIndex: 0,
            dataIndex: currentIndex
        });
        currentIndex = (currentIndex + 1) % dataLen;
    }, 1000);


    // 切换主题
    var currentTheme = 'default';

    // 切换主题的函数
    function toggleTheme() {
        // 切换当前主题
        currentTheme = currentTheme === 'default' ? 'infographic' : 'default';

        // 重新初始化图表
        chart1.dispose();
        chart1 = echarts.init(document.getElementById('chart1'), currentTheme);
        chart1.setOption(option1);
        chart2.dispose();
        chart2 = echarts.init(document.getElementById('chart2'), currentTheme);
        chart2.setOption(option2);
    }

    // 绑定按钮点击事件
    $('#themeButton').click(toggleTheme);

});